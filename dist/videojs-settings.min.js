!function(a,b){"use strict";function c(a){return"number"!=typeof a?a:Math.round(1e3*a)/1e3}var d,e,f,g=function(a,b){if(!b)return a;for(var c in b)Object.prototype.hasOwnProperty.call(b,c)&&(a[c]=b[c]);return a},h=b.getComponent("Menu");b.registerComponent("PopupMenu",b.extend(h,{className:"vjs-rightclick-popup",popped:!1,constructor:function(a,c){h.call(this,a,c);var d=a;this.addClass(this.className),this.hide();var e=this,f=this.options_,g=b.mergeOptions({label:"Report playback issue"},f.report);this.addChild(new m(a,g));var i=b.mergeOptions({label:"Save logs to disk"});this.addChild(new n(a,i)),f.info&&(f.info=b.mergeOptions({label:"Technical info"},f.info),this.addChild(new o(a,f.info))),d.on("contextmenu",function(a){if(a.preventDefault(),e.popped)e.hide(),e.popped=!1;else{e.show();var b=a.offsetX,c=a.offsetY;e.el_.offsetWidth+b>d.el_.offsetWidth&&(b-=e.el_.offsetWidth),e.el_.offsetHeight+c>d.el_.offsetHeight&&(c-=e.el_.offsetHeight),e.el_.style.top=c+"px",e.el_.style.left=b+"px",e.popped=!0}}),d.on("click",function(a){return e.popped?(e.hide(),e.popped=!1,a.stopPropagation(),a.preventDefault(),!1):void 0}),this.children().forEach(function(a){a.on("click",function(a){e.hide(),e.popped=!1})})}}));var i=b.getComponent("MenuButton");b.registerComponent("SettingsButton",b.extend(i,{buttonText:"Settings",className:"vjs-settings-button",createItems:function(){this.addClass(this.className);var a=[],c=this.player_,d=this.options_;d.info&&(d.info=b.mergeOptions({label:"Technical info"},d.info),a.push(new o(c,d.info))),d.report&&(d.report=b.mergeOptions({label:"Report playback issue"},d.report),a.push(new m(c,d.report)));var e=d.quality,f=e&&e.sources?e.sources:null;if(f&&f.length>1){a.push(new p(c,{label:"Quality"}));for(var g,h=0;h<f.length;h+=1)f[h].src&&(f[h].label||(f[h].label=f[h].type),g=new q(c,f[h]),g.addClass("vjs-menu-indent"),a.push(g))}return a}}));var j=b.getComponent("Component");b.registerComponent("Overlay",b.extend(j,{createEl:function(a,b){var c=this.options_["class"];c=c?" "+c:"";var d=j.prototype,e=d.createEl.call(this,"div",g({className:"vjs-info-overlay"+c},b));return this.createContent(e),e},createContent:function(a){}}));var k=b.getComponent("Overlay");b.registerComponent("InfoOverlay",b.extend(k,{info_data:{duration:{units:"sec",title:"Duration",get:function(a){return c(a.duration())}},position:{units:"sec",title:"Position",get:function(a){return c(a.currentTime())}},buffered:{units:"sec",title:"Current buffer",get:function(a){var b=a.buffered(),d=a.currentTime();if(b&&b.length)for(var e=0;e<b.length;e+=1)if(b.start(e)<=d&&b.end(e)>=d)return c(b.end(e)-d);return"--"}},downloaded:{units:"sec",title:"Downloaded",get:function(a){var b=a.buffered(),d=0;if(b&&b.length)for(var e=0;e<b.length;e+=1)d+=b.end(e)-b.start(e);return c(d)}}},createContent:function(a){function b(a,b){b=b?g(b):b;var d=j.prototype;return d.createEl.call(c,a,b)}var c=this,e=this.player_,f=b("div",{className:"vjs-info-overlay-title",innerHTML:"Technical info"}),h=b("div",{className:"vjs-info-overlay-x",innerHTML:"❌"});h.addEventListener("click",function(a){d&&d.toggle()});var i,k,l=b("div",{className:"vjs-info-overlay-content"}),m=b("ul",{className:"vjs-info-overlay-list"});for(var n in this.info_data)i=b("li",{className:"vjs-info-overlay-list-item"}),k=this.info_data[n].title,this.info_data[n].units&&(k+=" ["+this.info_data[n].units+"]"),k+=": ",i.appendChild(b("strong",{innerHTML:k})),this.info_data[n].el=b("span"),i.appendChild(this.info_data[n].el),m.appendChild(i);l.appendChild(m),a.appendChild(f),a.appendChild(h),a.appendChild(l),this.update(),e.on("timeupdate",function(){c.update()}),setInterval(function(){c.update()},1e3)},update:function(){var a=this.player_,b=this.info_data;for(var c in b)b[c].el.innerHTML=b[c].get(a)},toggle:function(a){return a&&(this.last_caller=a),this.visible?(this.visible=!1,this.last_caller&&this.last_caller.selected(!1),void this.addClass("vjs-hidden")):(this.update(),this.visible=!0,void this.removeClass("vjs-hidden"))}})),b.registerComponent("NotifyOverlay",b.extend(k,{createContent:function(a){function b(a,b){b=b?g(b):b;var d=j.prototype;return d.createEl.call(c,a,b)}var c=this,d=b("div",{className:"vjs-notify-overlay-title",innerHTML:"Issue report sent."}),e=b("div",{className:"vjs-notify-overlay-content",innerHTML:"Thank you!"});a.appendChild(d),a.appendChild(e)},flash:function(){if(!this.visible){this.visible=!0,this.removeClass("vjs-hidden");var a=this;setTimeout(function(){a.addClass("vjs-notify-flash")},50),setTimeout(function(){a.visible=!1,a.removeClass("vjs-notify-flash"),a.addClass("vjs-hidden")},3500)}}}));var l=b.getComponent("MenuItem"),m=b.registerComponent("ReportButton",b.extend(l,{constructor:function(a,b){l.call(this,a,b);var c=a;this.on("click",function(){c.trigger({type:"problem_report"}),e&&(e.flash(),this.selected(!1))})}})),n=b.registerComponent("LogButton",b.extend(l,{constructor:function(a,b){l.call(this,a,b);var c=a;this.on("click",function(){c.trigger({type:"save_logs"}),this.selected(!1)})}})),o=b.registerComponent("InfoButton",b.extend(l,{constructor:function(a,b){l.call(this,a,b),this.on("click",function(){d&&d.toggle(this)})}})),p=b.registerComponent("MenuLabel",b.extend(j,{createEl:function(a,b){var c=j.prototype;return c.createEl.call(this,"li",g({className:"vjs-menu-item vjs-menu-label",innerHTML:this.options_.label},b))}})),q=b.registerComponent("QualityButton",b.extend(l,{constructor:function(a,c){l.call(this,a,c),this.player_.one("play",b.bind(this,this.update)),this.player_.on("resolutionchange",b.bind(this,this.update))},handleClick:function(){var a=this.player_,c=this.options_;if("Html5"===a.techName_){if(a.cache_.src===c.src)return a.trigger("resolutionchange"),this;var d=a.currentTime(),e=a.paused();a.pause(),a.src(c.src),a.ready(function(){a.one("loadeddata",b.bind(this,function(){this.currentTime(d)})),a.trigger("resolutionchange"),e||(a.load(),a.play())})}},update:function(){this.selected(this.player_.cache_.src===this.options_.src)}}));b.plugin("settings_button",function(a){var c=this;c.on("ready",function(){(a.info||a.report||a.quality&&a.quality.sources&&a.quality.sources.length)&&c.controlBar.addChild("SettingsButton",b.mergeOptions({},a)),a.info&&(d=c.addChild("InfoOverlay",{}),d.addClass("vjs-hidden")),a.report&&(e=c.addChild("NotifyOverlay",{"class":"vjs-notify-overlay"}),e.addClass("vjs-hidden")),f=c.addChild("PopupMenu",b.mergeOptions({},a))})})}(window,window.videojs);